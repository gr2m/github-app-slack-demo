# Snapshot report for `test/unit/api-github-webhooks.test.js`

The actual snapshot is saved in `api-github-webhooks.test.js.snap`.

Generated by [AVA](https://avajs.dev).

## setupApp

> logs

    [
      [
        'info',
        'Set up Octokit app',
      ],
      [
        'info',
        'Set up Bolt app',
      ],
      [
        'info',
        'Register Octokit and Bolt handlers',
      ],
    ]

## setupApp() - called twice

> logs

    [
      [
        'info',
        'Set up Octokit app',
      ],
      [
        'info',
        'Set up Bolt app',
      ],
      [
        'info',
        'Register Octokit and Bolt handlers',
      ],
    ]

## setupApp() with error

> logs

    [
      [
        'info',
        'Set up Octokit app',
      ],
      [
        'error',
        Error {
          message: 'oops',
        },
        'Failed to set up Octokit and Slack clients',
      ],
    ]

## setupApp() with error - called twice

> logs

    [
      [
        'info',
        'Set up Octokit app',
      ],
      [
        'error',
        Error {
          message: 'oops',
        },
        'Failed to set up Octokit and Slack clients',
      ],
    ]

## POST /api/github-webhooks

> logs

    [
      [
        'info',
        {
          'event.id': '<event-delivery-guid>',
          'event.name': '<event-name>',
          'event.signature': '<event-delivery-signature>',
        },
        'Webhook received',
      ],
    ]

> response

    {
      body: '{"ok":true}',
      headers: {
        'Content-Type': 'application/json',
      },
      statusCode: 200,
    }

> app.webhooks.verifyAndReceive() calls

    [
      Arguments [
        {
          id: '<event-delivery-guid>',
          name: '<event-name>',
          payload: '<event-payload>',
          signature: '<event-delivery-signature>',
        },
      ],
    ]

## POST /api/github-webhooks with timeout

> logs

    [
      [
        'info',
        {
          'event.id': '<event-delivery-guid>',
          'event.name': '<event-name>',
          'event.signature': '<event-delivery-signature>',
        },
        'Webhook received',
      ],
    ]

> response

    {
      body: '{"stillProcessing":true}',
      headers: {
        'Content-Type': 'application/json',
      },
      statusCode: 202,
    }

> app.webhooks.verifyAndReceive() calls

    []

## error in app.webhooks.verifyAndReceive()

> response

    {
      body: '{"error":"Error: <verifyAndReceive-error>"}',
      headers: {
        'Content-Type': 'application/json',
      },
      statusCode: 400,
    }

> logs

    [
      [
        'info',
        {
          'event.id': '<event-delivery-guid>',
          'event.name': '<event-name>',
          'event.signature': '<event-delivery-signature>',
        },
        'Webhook received',
      ],
      [
        'error',
        {
          err: AggregateError {
            message: 'Hello',
          },
        },
        'Handler error',
      ],
    ]

## unexpected error in app.webhooks.verifyAndReceive()

> response

    {
      body: '{"error":"Error: An unexpected error occurred"}',
      headers: {
        'Content-Type': 'application/json',
      },
      statusCode: 500,
    }

> logs

    [
      [
        'info',
        {
          'event.id': '<event-delivery-guid>',
          'event.name': '<event-name>',
          'event.signature': '<event-delivery-signature>',
        },
        'Webhook received',
      ],
      [
        'error',
        {
          err: AggregateError {
            message: 'oops',
          },
        },
        'Handler error',
      ],
    ]

## Unexpected error in handler

> response

    {
      body: '{"error":"An unexpected error occurred"}',
      headers: {
        'Content-Type': 'application/json',
      },
      statusCode: 500,
    }

> logs

    [
      [
        'info',
        {
          'event.id': '<event-delivery-guid>',
          'event.name': '<event-name>',
          'event.signature': '<event-delivery-signature>',
        },
        'Webhook received',
      ],
      [
        'error',
        {
          err: Error {
            message: 'oops',
          },
        },
        'Handler error',
      ],
    ]

## GET /api/github-webhooks

> response

    {
      body: '{"error":"Method not allowed"}',
      headers: {
        'Content-Type': 'application/json',
      },
      statusCode: 405,
    }

> logs

    [
      [
        'info',
        {
          method: 'GET',
        },
        'Method not allowed',
      ],
    ]
